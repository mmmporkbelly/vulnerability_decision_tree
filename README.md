# The Vulnerability Decision Tree

## Overview

A principal problem of any Vulnerability Management team is the constant noise from CVEs. There were over 28,000 vulnerabilities added to the National Vulnerability Database in 2023 alone. These 28,000+ vulnerabilities also had an average CVSS score of a High Severity. The vulnerability decision tree aims to sort through this noise by categorizing vulnerabilities into 96 categories, which can then be sorted for priority within the category via EPSS. Furthermore, it is an automatable scanner/vendor agnostic approach to CVE prioritization which can be applied to any vulnerability assigned a CVE by the National Vulnerability Database. The tree was inspired by the Stakeholder Specific Vulnerability Catalogue (SSVC) developed by CISA and Carnegie Mellon to create a proprietary prioritization guide for CVEs, while maintaining the integrity of CVSS.

## Considerations

 - Agnostic approach: Most scanners and vulnerability intelligence databases provide additional information for prioritization, but there are two problems with this. First, such companies do not provide any clarifying details into what goes into their “secret sauce”, which means security teams have to blindly trust what the vendor says in regard to priority. Second, it does not allow for a unified approach across different scanners and different environments.
 - Automatable: Any prioritization proposed has to be easily automatable; otherwise, there is no point.
 - CVSS scores: CVSS scores are the best way to help determine severity for a specific asset in a specific environment in a scanner agnostic manner. As noted in the CVSS Specification Document, “the acceptable deviation was a value of 0.5. That is, all the metric value combinations used to derive the weights and calculation will produce a numeric score within its assigned severity level, or within 0.5 of that assigned level.” Although a severity for a CVE may be accurate, the previous statement implies that score-based prioritization of a CVE within a severity can be improved.
 - Environmental Factor Automation: Although using and automating the calculation of CVSS Environmental scores would be ideal, the automation of environmental scores is difficult.
 - Exploitability: CVSS does not provide context on exploit code maturity other than High, Functional, Proof of Concept, Unproven. It also, by nature, does not try to predict the likelihood of exploitability, or the associations a CVE may have to certain APTs.

## The Decision Tree 

A key component in the thought process of the decision tree was to make something that is easily automatable and with flexible branches. Each branch can be automated and/or removed if automation is not within scope for the organization that adopts this (except for the first: CVSS severity).

![Decision Tree v3](https://github.com/mmmporkbelly/vulnerability_decision_tree/assets/123842007/d4e39154-d1d2-4a3b-a2d4-6ebbb5660197)

## Breakdown of the branches

### CVSS Severity
CVSS is an open set of standards developed by first.org used to assess a vulnerability and assign a score along a scale of 0-10. Many security teams uses CVSS for scoring all CVE related vulnerabilities. The NVD (National Vulnerability Database) run by NIST provides base scores and vectors for CVEs. Severities are then assigned via the following score categories:
 - Critical - CVSS score 9.0 - 10.0
 - High - CVSS score 7.0 - 8.9
 - Medium - CVSS score 4.0-6.9
 - Low - CVSS score 0 - 4.0

CVSS base scores are not meant to be used as a standard for measuring risk. Therefore, the following project was created to automate temporal scores: [the temporal score database](https://github.com/mmmporkbelly/temporal_score_database)
Although it is recommended to use a CVSS Score/Vector that is Temporal or Environmental, base scores can theoretically be used provided the following conditions:
 - The temporal vector portion is not used
 - At least one other branch (Data Confidentiality, Asset Exposure) is used
 - Asset ExposureAsset exposure is synonymous with internet exposure.

### Asset Exposure
Here are the definitions of the following branches within asset exposure:
 - Wide Internet Exposure - Anybody on the internet can access this asset on an open port.
 - Internet Exposure - Asset’s ports are open to the internet, but are restricted to specific roles / IPs.
 - No Internet Exposure - Asset can only be reached assets in the same private subnet.

Most vulnerability scanners check for some level of exposure - Internet Exposure may not be defined depending on the vulnerability scanner, but at the very least findings should be separated by Wide Internet Exposure and No Internet Exposure.

### Asset Criticality
This is a trickier problem for most orgs. Some scanners do try to automate asset criticality, but it is mostly done on a tagging basis for most orgs. Again, this branch can be taken out if necessary.

### Temporal Vector
The temporal vector is already predetermined thanks to the severity calculations. See [the temporal score database](https://github.com/mmmporkbelly/temporal_score_database) for a detailed explanation of each vector. Findings are prioritized by exploit maturity in the following order:
 - E:H (High)
 - E:F (Functional)
 - E:P (Proof of Concept)
 - E:U (Unproven)EPSS

### Exploit Prediction Scoring System
The Exploit Prediction Scoring System (EPSS) is a data-driven effort for estimating the likelihood (probability) that a software vulnerability will be exploited in the wild. EPSS was developed by the same team (first.org) that is in charge of developing CVSS to supplement CVSS. CVSS is useful for capturing innate characteristics of a vulnerability and provide measures of severity, but is limited in their ability to assess threat. EPSS fills that gap because it uses current threat information from CVE and real-world exploit data. The EPSS model produces a probability score between 0 and 1 (0 and 100%). The higher the score, the greater the probability that a vulnerability will be exploited. This last branch helps prioritize vulnerabilities if there are hundreds of vulnerabilities within a single branch.

## Conclusion
The goal of Vulnerability Management is to identify and remediate the vulnerabilities with the highest chance of exploitation; in other words, identify and fix the lowest hanging fruit. This is incredibly important for the current state of vulnerabilities at organizations, as it may seem like an insurmountable task to prioritize the hundreds of thousands of CVEs. The proposed decision tree will split the vulnerabilities identified by Wiz into 96 categories, allowing vulnerability management analysts to accurately assess and prioritize infrastructure vulnerabilities in a scanner agnostic manner. Furthermore, the temporal score in the first branch of the tree may also be replaced by environmental scores, allowing for the decision tree to be kept as a vulnerability management program matures.
